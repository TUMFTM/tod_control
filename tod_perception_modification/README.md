# tod_perception_modification

With the Perception Modification (PM), the operator communicates to the
automated vehicle (AV) that certain hindering but neglectable detections or
gridmap reflections
can be driven over ([PDF](https://www.scitepress.org/Papers/2021/104333/104333.pdf)).
The operator interacts with the HMI of
[tod_visual](../../tod_operator_interface/tod_visual/README.md). This
package processes its outputs.

The most important nodes are OperatorPerceptionModification and VehiclePerceptionModification.
All other nodes are built around those to serve their functionality.

## Operator

The tod_visual publishes the operator's mouseclicks and keypresses:

- /Operator/Visual/MousePositionClick
- /Operator/Visual/KeyPress

The node 'OperatorPerceptionModification' processes those interactions.

- Mouse click: Specifies edge of polygon which marks area
- ENTF: Deletes stored mouse clicks
- ENTER: Submit and approve polygon (Hit ENTER twice)
- 5 on numpad: decrease velocity of AV (optional)
- 8 on numpad: increase velocity of AV (optional)

After submission and approval, the interactions are sent to the VehiclePerceptionModification.

## Vehicle

The VehiclePerceptionModification subscribes to the object list and the gridmap data.
If an object or an reflection lies within an approved polygon which was send from
the OperatorPerceptionModification, it is deleted. The modified object list and
modified grid map is published for usage at the PathToCollisionFreePath node.

A rudimental path following algorithm is implemented in order to simulate AV behaviour. The vehicle follows a xml-path provided by [tod_navigation](../tod_navigation/README.md) and brakes when a collision with an object within that path would be imminent. This behaviour is mainly generated by the following nodes:

- RouteToPath
- PathToCollisionFreePath
- PurePursuit ([tod_pure_pursuit](../tod_pure_pursuit/README.md))
- ControlCommandCreator

In order to simulate false positive detections or neglectable lidar reflections, those can be specified with yaml-files ([objects](yaml/seven_fake_objects.yaml) or [reflection](yaml/reflection_pedestrian_crossing.yaml)) and are published by the FakeObjectsPublisher or the FakeCellsPublisher.

- VehicleFakeObjectsPublisher
- VehicleFakeCellsPublisher

## Dependencies

* Libraries

    ```bash
    sudo apt-get install libglfw3-dev -y
    sudo apt-get install libglm-dev -y
    ```

## Reference

This package contains the code that implements the concept published in VEHITS 2021 ([PDF](https://www.scitepress.org/Papers/2021/104333/104333.pdf)):

> J. Feiler and F. Diermeyer,
> **"The Perception Modification Concept to Free the Path of An Automated Vehicle Remotely"**,
> in VEHITS 2021 - Proceedings of the 7th International Conference on Vehicle Technology
> and Intelligent Transport Systems, SCITEPRESS.

    @inproceedings{DBLP:conf/vehits/FeilerD21,
    author    = {Johannes Feiler and
                Frank Diermeyer},
    editor    = {Karsten Berns and
                Markus Helfert and
                Oleg Gusikhin},
    title     = {The Perception Modification Concept to Free the Path of An Automated
                Vehicle Remotely},
    booktitle = {Proceedings of the 7th International Conference on Vehicle Technology
                and Intelligent Transport Systems, {VEHITS} 2021, Online Streaming,
                April 28-30, 2021},
    pages     = {405--412},
    publisher = {{SCITEPRESS}},
    year      = {2021},
    url       = {https://doi.org/10.5220/0010433304050412},
    doi       = {10.5220/0010433304050412},
    timestamp = {Fri, 28 May 2021 17:23:03 +0200},
    biburl    = {https://dblp.org/rec/conf/vehits/FeilerD21.bib},
    bibsource = {dblp computer science bibliography, https://dblp.org}
    }
